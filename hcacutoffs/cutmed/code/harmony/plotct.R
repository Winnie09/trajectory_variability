d <- readRDS('/home-4/whou10@jhu.edu/scratch/Wenpin/trajectory_variability/hcacutoffs/cutmed/harmony/pca.rds')
clu <- readRDS('/home-4/whou10@jhu.edu/scratch/Wenpin/trajectory_variability/hcacutoffs/cutmed/harmony/cluster.rds')
ct <- readRDS('/home-4/whou10@jhu.edu/scratch/Wenpin/trajectory_variability/hcacutoffs/cutmed/harmony/ct.rds')
library(ggplot2)
library(gridExtra)
library(scattermore)
source('/home-4/whou10@jhu.edu/scratch/Wenpin/resource/ggplot_theme.R')
theme_set(.new_theme)
pdf('/home-4/whou10@jhu.edu/scratch/Wenpin/trajectory_variability/hcacutoffs/cutmed/harmony/ct.pdf',width=7.5,height=1.5)
p1 <- ggplot(data.frame(pc1=d[,1],pc2=d[,2],celltype=ct[clu]),aes(x=pc1,y=pc2,col=celltype)) + geom_scattermore(size=0.5) + xlab('Principal component 1') + ylab('Principal component 2')
p2 <- ggplot(data.frame(pc1=d[,1],pc3=d[,3],celltype=ct[clu]),aes(x=pc1,y=pc3,col=celltype)) + geom_scattermore(size=0.2)  + xlab('Principal component 1') + ylab('Principal component 3')
p3 <- ggplot(data.frame(pc2=d[,2],pc3=d[,3],celltype=ct[clu]),aes(x=pc2,y=pc3,col=celltype)) + geom_scattermore(size=0.2) + xlab('Principal component 2') + ylab('Principal component 3')
grid.arrange(p1,p2,p3,nrow=1)
dev.off()


